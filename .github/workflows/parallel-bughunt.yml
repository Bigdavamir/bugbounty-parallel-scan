name: Simple Run main.sh

on:
  workflow_dispatch:
    inputs:
      domain:
        description: 'Target domain'
        required: true

jobs:
  run-once:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set script permissions
        run: chmod +x main.sh

      - name: Install golang
        uses: actions/setup-go@v5
        with:
          go-version: '1.22'

      - name: Install required tools
        run: |
          go install github.com/hakluke/waybackurls@latest
          go install github.com/lc/gau/v2/cmd/gau@latest
          go install github.com/projectdiscovery/httpx/cmd/httpx@latest
          go install github.com/Sh1Yo/x8@latest
          go install github.com/Emoe/kxss@latest
          go install github.com/tomnomnom/unfurl@latest
          go install github.com/tomnomnom/anew@latest
          export PATH=$PATH:$(go env GOPATH)/bin
          echo 'export PATH=$PATH:$(go env GOPATH)/bin' >> $GITHUB_ENV

      - name: Run bash script
        run: |
          export PATH=$PATH:$(go env GOPATH)/bin
          ./main.sh ${{ github.event.inputs.domain }}
